# Virtual Private Cloud (VPC)

Amazon Virtual Private Cloud (Amazon VPC) enables you to launch AWS resources into a virtual network that you've defined. This virtual network closely resembles a traditional network that you'd operate in your own data center, with the benefits of using the scalable infrastructure of AWS. 

## Features

The following are the key concepts for VPCs:

- Virtual private cloud (VPC)
  - A virtual network dedicated to your AWS account. 
- Subnet
  -  A range of IP addresses in your VPC. 
- Route table
  - A set of rules, called routes, that are used to determine where network traffic is directed. 
- Internet gateway
  - A gateway that you attach to your VPC to enable communication between resources in your VPC and the internet. 
- VPC endpoint
  - Enables you to privately connect your VPC to supported AWS services and VPC endpoint services powered by PrivateLink without requiring an internet gateway, NAT device, VPN connection, or AWS Direct Connect connection.
- CIDR block
  - Classless Inter-Domain Routing. An internet protocol address allocation and route aggregation methodology.

## Exam Tips

- VPC
  - Think of a VPC as a logical datacenter in AWS
  - Consists of the follow:
    - Internet Gateways (or Virtual Private Gateways)
    - Route Tables
    - Network Access Control Lists
    - Subnets
    - Security Groups
  - 1 Subnet = 1 Availability Zone
  - Security Groups are Stateful
  - Network Access Control Lists are Stateless
  - **NO TRANSITIVE PEERING**
- Custom VPC
  - Amazon always reserves 5 IP addresses with each subnet
  - There can only be 1 internet gateway per VPC
  - Security Groups can't span VPCs
- Network ACL
  - VPCs automatically come with a default ACL
    - Allows all outbound and inbound traffic by default
  - Can create custom Network ACLs as well
    - Blocks all outbound and inbound traffic by default
  - Each subnet in a VPC must be associated with a Network ACL
  - Use Network ACLs to block IP addresses instead of Security Groups
  - A Network ACL can be associated with multiple subnets
    - A Subnet can be associated with only a single Network ACL
  - Network ACLs contain a numbered list of rules that is evaluated in order, starting with the lowest numbered rule.
  - Network ACLs have separate inbound and outbound rules, and rule can either allow or deny traffic
  - Network ACLs are stateless; responses to allowed inbound traffic are subject to the rules for outbound traffic (and vice versa)
- VPC Flowlogs
  - You cannot enable flow logs for VPCs that are peered with your VPC unless the peer VPC is in your account
  - You can tag flow logs
  - You can't change the configuration of a flow log after creating it
  - Not all IP traffic is monitored
    - Traffic generated by instances when the contact the Amazon DNS server
    - Traffic generated by a Windows instance for Amazon Windows license activation
    - Traffic to and from 169.254.169.254 for instance metadata
    - DHCP traffic
    - Traffic to the reserved IP address for the default VPC router
- Bastions
  - A NAT Gateway is used to provide internet traffic to EC2 instances in a private subnet
  - A Bastion is used to securely adminiter EC2 instances (SSH/RDP)
  - You cannot use a NAT Gateway as a Bastion host